import telebot
import sqlite3
from telebot import types
import gitignore.tokens

bot = telebot.TeleBot(gitignore.tokens.bot_token)
sql_connection = sqlite3.connect('test.db',  check_same_thread=False)
cursor = sql_connection.cursor()
sql_connection.commit()


@bot.message_handler(commands=['start'])
def start(message):
    entertainment_categories = types.ReplyKeyboardMarkup(resize_keyboard=True)
    entertainment_categories.add('–ò–≥—Ä—ãüéÆ', '–§–∏–ª—å–º—ãüé¨', '–ö–Ω–∏–≥–∏üìö')
    bot.send_message(message.chat.id,
                     '<i>–ü—Ä–∏–≤–µ—Ç!</i>\n–° –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ –±–æ—Ç–∞ —Ç—ã —Å–º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏ —Å–µ–±–µ <b>–∫–Ω–∏–≥—É/—Ñ–∏–ª—å–º/–∏–≥—Ä—É</b> –Ω–∞ –≤–µ—á–µ—Ä',
                     parse_mode='HTML', reply_markup=entertainment_categories)


@bot.message_handler(content_types=['text'])
def main(message):
    entertainment_categories = types.ReplyKeyboardMarkup(resize_keyboard=True)
    entertainment_categories.add('–ò–≥—Ä—ãüéÆ', '–§–∏–ª—å–º—ãüé¨', '–ö–Ω–∏–≥–∏üìö')
    if message.text == '–ò–≥—Ä—ãüéÆ':
        show_games(message)
    if message.text == 'üîô–ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é':
        bot.send_message(message.chat.id, '–í—ã–±–µ—Ä–∏ —Ç–∏–ø —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è', parse_mode='HTML',
                         reply_markup=entertainment_categories)


def show_games(message):
    games_categories = types.ReplyKeyboardMarkup(resize_keyboard=True)
    games_categories.add('üîô–ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', '–¢–æ–ø 10 –ª—É—á—à–∏—Ö –∏–≥—Ä –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω', '–¢–æ–ø 10 –†–ü–ì –∏–≥—Ä', '–¢–æ–ø 10 —à—É—Ç–µ—Ä–æ–≤',
                         row_width=1)
    msg = bot.send_message(message.chat.id, '<i>–í—ã–±–µ—Ä–∏ –∂–∞–Ω—Ä –∏–≥—Ä</i>', reply_markup=games_categories, parse_mode='HTMl')
    bot.register_next_step_handler(msg, show_games_from_categories)


def show_games_from_categories(message):
    if message.text == '–¢–æ–ø 10 –ª—É—á—à–∏—Ö –∏–≥—Ä –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω':
        cursor.execute('select * from top10_games_all_time')
        games_from_top10_best = cursor.fetchall()
        for row in games_from_top10_best:
            bot.send_message(message.chat.id, f'–ù–∞–∑–≤–∞–Ω–∏–µ: {row[0]}\n –ü–ª–∞—Ç—Ñ–æ—Ä–º—ã: {row[1]}\n –î–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞: {row[2]}\n –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ: {row[3]}\n –û—Ü–µ–Ω–∫–∞ –Ω–∞ –º–µ—Ç–∞–∫—Ä–∏—Ç–∏–∫–µ: {row[4]}')


bot.infinity_polling()
